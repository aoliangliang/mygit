<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.newtouch.blockchain.dao.TxRecordDao">
  <resultMap id="BaseResultMap" type="com.newtouch.blockchain.entity.TxRecord">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="ID" jdbcType="VARCHAR" property="id" />
    <result column="FIRST_INSERT" jdbcType="TIMESTAMP" property="firstInsert" />
    <result column="LAST_MODIFIED" jdbcType="TIMESTAMP" property="lastModified" />
    <result column="CREATE_USER" jdbcType="VARCHAR" property="createUser" />
    <result column="UPDATE_USER" jdbcType="VARCHAR" property="updateUser" />
    <result column="DELETED" jdbcType="BIT" property="deleted" />
    <result column="DEL_REASON" jdbcType="VARCHAR" property="delReason" />
    <result column="ACCOUNT_FROM" jdbcType="VARCHAR" property="accountFrom" />
    <result column="ACCOUNT_TO" jdbcType="VARCHAR" property="accountTo" />
    <result column="AMOUNT" jdbcType="DECIMAL" property="amount" />
    <result column="HASH" jdbcType="VARCHAR" property="hash" />
    <result column="TRANS_TIME" jdbcType="TIMESTAMP" property="transTime" />
    <result column="BLOCK_NUMBER" jdbcType="BIGINT" property="blockNumber" />
    <result column="NONCE" jdbcType="BIGINT" property="nonce" />
    <result column="GASPRICE" jdbcType="DECIMAL" property="gasprice" />
  </resultMap>
  <sql id="baseSql">
  	ID, FIRST_INSERT, LAST_MODIFIED, CREATE_USER, UPDATE_USER, DELETED, DEL_REASON, 
    ACCOUNT_FROM, ACCOUNT_TO, AMOUNT, HASH, TRANS_TIME, BLOCK_NUMBER, NONCE, GASPRICE
  </sql>
  <delete id="deleteById" parameterType="java.lang.String">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    delete from TBL_TX_RECORD
    where ID = #{id,jdbcType=VARCHAR}
  </delete>
  <insert id="insert" parameterType="com.newtouch.blockchain.entity.TxRecord">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into TBL_TX_RECORD (ID, FIRST_INSERT, LAST_MODIFIED, 
      CREATE_USER, UPDATE_USER, DELETED, 
      DEL_REASON, ACCOUNT_FROM, ACCOUNT_TO, 
      AMOUNT, HASH, TRANS_TIME, BLOCK_NUMBER,
      NONCE,GASPRICE
      )
    values (#{id,jdbcType=VARCHAR}, #{firstInsert,jdbcType=TIMESTAMP}, #{lastModified,jdbcType=TIMESTAMP}, 
      #{createUser,jdbcType=VARCHAR}, #{updateUser,jdbcType=VARCHAR}, #{deleted,jdbcType=BIT}, 
      #{delReason,jdbcType=VARCHAR}, #{accountFrom,jdbcType=VARCHAR}, #{accountTo,jdbcType=VARCHAR}, 
      #{amount,jdbcType=DECIMAL}, #{hash,jdbcType=VARCHAR}, #{transTime,jdbcType=TIMESTAMP}, #{blockNumber,jdbcType=BIGINT},
      #{nonce,jdbcType=BIGINT},#{gasprice,jdbcType=DECIMAL}
      )
  </insert>
  <update id="updateById" parameterType="com.newtouch.blockchain.entity.TxRecord">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update TBL_TX_RECORD
    set FIRST_INSERT = #{firstInsert,jdbcType=TIMESTAMP},
      LAST_MODIFIED = #{lastModified,jdbcType=TIMESTAMP},
      CREATE_USER = #{createUser,jdbcType=VARCHAR},
      UPDATE_USER = #{updateUser,jdbcType=VARCHAR},
      DELETED = #{deleted,jdbcType=BIT},
      DEL_REASON = #{delReason,jdbcType=VARCHAR},
      ACCOUNT_FROM = #{accountFrom,jdbcType=VARCHAR},
      ACCOUNT_TO = #{accountTo,jdbcType=VARCHAR},
      AMOUNT = #{amount,jdbcType=DECIMAL},
      HASH = #{hash,jdbcType=VARCHAR},
      TRANS_TIME = #{transTime,jdbcType=TIMESTAMP},
      BLOCK_NUMBER = #{blockNumber,jdbcType=BIGINT},
      NONCE = #{nonce,jdbcType=BIGINT},
      GASPRICE = #{gasprice,jdbcType=DECIMAL}
    where ID = #{id,jdbcType=VARCHAR}
  </update>
  <select id="selectById" parameterType="java.lang.String" resultMap="BaseResultMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select <include refid="baseSql"/>
    from TBL_TX_RECORD
    where ID = #{id,jdbcType=VARCHAR}
  </select>
  <select id="selectAll" resultMap="BaseResultMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select <include refid="baseSql"/>
    from TBL_TX_RECORD order by TRANS_TIME desc,NONCE desc
  </select>
  
  <select id="findByAddress" resultMap="BaseResultMap" parameterType="java.lang.String">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select <include refid="baseSql"/>
    from TBL_TX_RECORD where ACCOUNT_FROM = #{address,jdbcType=VARCHAR} or ACCOUNT_TO = #{address,jdbcType=VARCHAR} order by TRANS_TIME desc,NONCE desc
  </select>
  
  <select id="findByAddressFrom" resultMap="BaseResultMap" parameterType="java.lang.String">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select <include refid="baseSql"/>
    from TBL_TX_RECORD where ACCOUNT_FROM = #{address,jdbcType=VARCHAR} order by TRANS_TIME desc,NONCE desc
  </select>
  
  <select id="findByAddressTo" resultMap="BaseResultMap" parameterType="java.lang.String">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select <include refid="baseSql"/>
    from TBL_TX_RECORD where ACCOUNT_TO = #{address,jdbcType=VARCHAR} order by TRANS_TIME desc,NONCE desc
  </select>
  
  <select id="findByAddressFromAndDate" resultMap="BaseResultMap" parameterType="java.lang.String">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select <include refid="baseSql"/>
    from TBL_TX_RECORD where ACCOUNT_FROM = #{address,jdbcType=VARCHAR} AND TRANS_TIME BETWEEN #{startDate,jdbcType=VARCHAR} AND #{endDate,jdbcType=VARCHAR} order by TRANS_TIME desc,NONCE desc
  </select>
  
  <select id="findByAddressToAndDate" resultMap="BaseResultMap" parameterType="java.lang.String">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select <include refid="baseSql"/>
    from TBL_TX_RECORD where ACCOUNT_TO = #{address,jdbcType=VARCHAR} AND TRANS_TIME BETWEEN #{startDate,jdbcType=VARCHAR} AND #{endDate,jdbcType=VARCHAR} order by TRANS_TIME desc,NONCE desc
  </select>
  
  <select id="findMaxBlockNumber" resultType="java.lang.Long">
  	SELECT MAX(BLOCK_NUMBER) FROM TBL_TX_RECORD
  </select>
  
  <select id="findMinBlockNumber" resultType="java.lang.Long">
  	SELECT MIN(BLOCK_NUMBER) FROM TBL_TX_RECORD
  </select>
  
  <select id="findCount" resultType="java.lang.Integer">
  	SELECT COUNT(*) FROM TBL_TX_RECORD
  </select>
  
  <select id="findSumTx" resultType="java.math.BigDecimal">
  	SELECT SUM(AMOUNT) FROM TBL_TX_RECORD
  </select>
  
  <select id="findByPage" resultMap="BaseResultMap" parameterType="java.lang.String">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select <include refid="baseSql"/>
    from TBL_TX_RECORD LIMIT #{start,jdbcType=INTEGER},#{size,jdbcType=INTEGER} order by TRANS_TIME desc
  </select>
  <select id="findByDate" resultMap="BaseResultMap" parameterType="java.lang.String">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select <include refid="baseSql"/>
    from TBL_TX_RECORD where TRANS_TIME BETWEEN #{startDate,jdbcType=VARCHAR} AND #{endDate,jdbcType=VARCHAR} order by TRANS_TIME desc
  </select>
  
  <select id="findByHash" resultMap="BaseResultMap" parameterType="java.lang.String">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select <include refid="baseSql"/>
    from TBL_TX_RECORD where HASH = #{hash,jdbcType=VARCHAR} order by TRANS_TIME desc
  </select>
  <select id="findMountTxOut" parameterType="java.lang.String" resultType="java.math.BigDecimal">
  	SELECT MAX(AMOUNT) FROM TBL_TX_RECORD where ACCOUNT_FROM = #{address,jdbcType=VARCHAR}
  </select>
  <select id="findMountTxIn" parameterType="java.lang.String" resultType="java.math.BigDecimal">
  	SELECT MAX(AMOUNT) FROM TBL_TX_RECORD where ACCOUNT_TO = #{address,jdbcType=VARCHAR}
  </select>
  <select id="findOutNumByAddress" parameterType="java.lang.String" resultType="java.math.BigDecimal">
    select COUNT(*)
    from TBL_TX_RECORD where ACCOUNT_FROM = #{address,jdbcType=VARCHAR}
  </select>
   <select id="findInNumByAddress" parameterType="java.lang.String" resultType="java.math.BigDecimal">
    select COUNT(*)
    from TBL_TX_RECORD where ACCOUNT_TO= #{address,jdbcType=VARCHAR}
  </select>
  
</mapper>